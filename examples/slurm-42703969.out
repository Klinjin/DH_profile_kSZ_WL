/global/u1/l/lindajin/virtualenvs/env1/lib/python3.11/site-packages/jaxlib/plugin_support.py:71: RuntimeWarning: JAX plugin jax_cuda12_plugin version 0.6.1 is installed, but it is not compatible with the installed jaxlib version 0.7.1, so it will not be used.
  warnings.warn(
ðŸŒŒ Physics-Informed Neural Network Training
==================================================
ðŸ“Š GP Benchmark: 80.6% test MAPE (severe overfitting from 29% training)
ðŸŽ¯ NN Target: <80% test MAPE + good generalization

ðŸš€ Physics-Informed Neural Network Training Demo
============================================================
ðŸ“Š Demo Configuration:
   â€¢ Simulations: 50 (scales to 1000+ for production)
   â€¢ Filter: CAP (kinetic SZ)
   â€¢ Particle: gas
   â€¢ Expected training time: 10-20 minutes (scales to 2-8 hours)
   â€¢ Architecture: Simplified for convergence (physics constraints disabled initially)

ðŸ§  Model Architecture (Simplified for Convergence):
   â€¢ Physics constraints: False, False, False
   â€¢ Hidden layers: [128, 64, 32]
   â€¢ Uncertainty method: single
   â€¢ Activation: relu
Loading data for 50 simulations...
Getting mean gas profiles with CAP filter for 50 simulations...
Finished getting mean profiles from 50 simulations.
Output shape: (50, 21) vs individual halo shape would be (n_halos*50, 21)
Raw data loaded:
  - Profiles: (50, 21)
  - Masses: (50,)
  - Params: (50, 35)
  - PkRatio: (50, 79)
Applying data transformations...
Log mass range: [13.03, 14.22]
âœ… Features normalized (zero mean, unit variance)
Final data shapes:
  - Features: (50, 115)
  - Targets: (50, 21)
Creating train/validation/test splits...
Split created:
  - Train: 40 samples (80.0%)
  - Val:   5 samples (10.0%)
  - Test:  5 samples (10.0%)
âœ… DataLoader initialized:
  - Dataset size: 50 samples, 115 features
  - Train/Val/Test: 40/5/5
  - Batch size: 32

ðŸ“Š Dataset Information:
   â€¢ Total samples: 50
   â€¢ Features: 115 (35 cosmo + 1 mass + 79 PK)
   â€¢ Target radius bins: 21
   â€¢ Train/Val/Test: 40/5/5
ðŸ–¥ï¸  JAX Device Configuration:
   â€¢ Available devices: 1
   â€¢ Default device: TFRT_CPU_0
   â€¢ GPU available: False
   ðŸ’» CPU training (consider GPU for faster training)

ðŸƒ Starting Training...
   â€¢ Physics constraints will guide the training process
   â€¢ Uncertainty estimation via deep ensemble
   â€¢ Early stopping based on validation loss
   â€¢ Results saved to: /pscratch/sd/l/lindajin/DH_profile_kSZ_WL/trained_gp_models/physics_nn_20250910_215758
ðŸ”¬ Training Physics-Informed Neural Network
  - Dataset: 50 samples
  - Features: 115
  - Targets: 21 radius bins
  - Physics constraints: Mass scaling, Cosmology attention, PK suppression
  - Training config: 1000 epochs, 200 patience
ðŸš€ Model initialized:
  - Architecture: Physics-informed single
  - Physics constraints: False, False, False
  - Uncertainty method: single
Training:   0%|                                                                                                         | 0/1000 [00:00<?, ?it/s]Training:   0%|                                                                                               | 1/1000 [00:07<1:59:03,  7.15s/it]Training:   0%|â–Ž                                                                                                | 3/1000 [00:07<31:54,  1.92s/it]Training:   0%|â–                                                                                                | 5/1000 [00:07<16:10,  1.02it/s]Training:   1%|â–‹                                                                                                | 7/1000 [00:07<09:53,  1.67it/s]Training:   1%|â–Š                                                                                                | 9/1000 [00:07<06:39,  2.48it/s]Training:   1%|â–ˆ                                                                                               | 11/1000 [00:07<04:47,  3.44it/s]Training:   1%|â–ˆâ–                                                                                              | 13/1000 [00:08<03:38,  4.51it/s]Training:   2%|â–ˆâ–                                                                                              | 15/1000 [00:08<02:53,  5.67it/s]Training:   2%|â–ˆâ–‹                                                                                              | 17/1000 [00:08<02:24,  6.81it/s]Training:   2%|â–ˆâ–Š                                                                                              | 19/1000 [00:08<02:04,  7.88it/s]Training:   2%|â–ˆâ–ˆ                                                                                              | 21/1000 [00:08<01:50,  8.83it/s]Training:   2%|â–ˆâ–ˆâ–                                                                                             | 23/1000 [00:08<01:41,  9.63it/s]Training:   2%|â–ˆâ–ˆâ–                                                                                             | 25/1000 [00:09<01:34, 10.28it/s]Training:   3%|â–ˆâ–ˆâ–Œ                                                                                             | 27/1000 [00:09<01:30, 10.78it/s]Training:   3%|â–ˆâ–ˆâ–Š                                                                                             | 29/1000 [00:09<01:29, 10.90it/s]Training:   3%|â–ˆâ–ˆâ–‰                                                                                             | 31/1000 [00:09<01:26, 11.21it/s]Training:   3%|â–ˆâ–ˆâ–ˆâ–                                                                                            | 33/1000 [00:09<01:24, 11.46it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–Ž                                                                                            | 35/1000 [00:09<01:22, 11.66it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–Œ                                                                                            | 37/1000 [00:10<01:21, 11.79it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–‹                                                                                            | 39/1000 [00:10<01:20, 11.88it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–‰                                                                                            | 41/1000 [00:10<01:20, 11.94it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                           | 43/1000 [00:10<01:19, 11.99it/s]Training:   4%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                           | 45/1000 [00:10<01:19, 12.01it/s]Training:   5%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                           | 47/1000 [00:10<01:19, 12.04it/s]Training:   5%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                           | 49/1000 [00:11<01:18, 12.07it/s]Epoch   50: Train=517304442135766538209198080.000000, Val=inf, Physics=0.000091, Time=0.0h
Training:   5%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                           | 51/1000 [00:11<01:18, 12.07it/s]Training:   5%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                           | 53/1000 [00:11<01:18, 11.99it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                          | 55/1000 [00:11<01:18, 12.02it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                          | 57/1000 [00:11<01:18, 12.05it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                          | 59/1000 [00:11<01:17, 12.07it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                          | 61/1000 [00:12<01:17, 12.10it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                          | 63/1000 [00:12<01:17, 12.11it/s]Training:   6%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                         | 65/1000 [00:12<01:17, 12.12it/s]Training:   7%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                         | 67/1000 [00:12<01:17, 12.11it/s]Training:   7%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                         | 69/1000 [00:12<01:16, 12.11it/s]Training:   7%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                         | 71/1000 [00:12<01:16, 12.12it/s]Training:   7%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                         | 73/1000 [00:13<01:16, 12.12it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                        | 75/1000 [00:13<01:16, 12.12it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                        | 77/1000 [00:13<01:16, 12.13it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                        | 79/1000 [00:13<01:15, 12.13it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                        | 81/1000 [00:13<01:15, 12.11it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                        | 83/1000 [00:13<01:15, 12.11it/s]Training:   8%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                       | 85/1000 [00:14<01:15, 12.12it/s]Training:   9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                       | 87/1000 [00:14<01:15, 12.11it/s]Training:   9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                       | 89/1000 [00:14<01:15, 12.10it/s]Training:   9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                       | 91/1000 [00:14<01:15, 12.10it/s]Training:   9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                       | 93/1000 [00:14<01:15, 11.98it/s]Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                       | 95/1000 [00:14<01:15, 12.02it/s]Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                      | 97/1000 [00:15<01:14, 12.05it/s]Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                      | 99/1000 [00:15<01:14, 12.07it/s]Epoch  100: Train=600503205511428389841403904.000000, Val=inf, Physics=0.000168, Time=0.0h
Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                     | 101/1000 [00:15<01:14, 12.08it/s]Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                     | 103/1000 [00:15<01:14, 12.09it/s]Training:  10%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                     | 105/1000 [00:15<01:14, 12.08it/s]Training:  11%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                    | 107/1000 [00:15<01:13, 12.09it/s]Training:  11%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                    | 109/1000 [00:16<01:13, 12.09it/s]Training:  11%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                    | 111/1000 [00:16<01:13, 12.09it/s]Training:  11%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                    | 113/1000 [00:16<01:13, 12.09it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                    | 115/1000 [00:16<01:13, 12.08it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                    | 117/1000 [00:16<01:31,  9.64it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                   | 119/1000 [00:17<01:26, 10.16it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                   | 121/1000 [00:17<01:22, 10.66it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                   | 123/1000 [00:17<01:19, 11.04it/s]Training:  12%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                   | 125/1000 [00:17<01:17, 11.33it/s]Training:  13%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                   | 127/1000 [00:17<01:15, 11.55it/s]Training:  13%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                  | 129/1000 [00:17<01:14, 11.71it/s]Training:  13%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                  | 131/1000 [00:18<01:13, 11.83it/s]Training:  13%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                  | 133/1000 [00:18<01:12, 11.92it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                  | 135/1000 [00:18<01:12, 11.97it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                  | 137/1000 [00:18<01:11, 11.99it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                 | 139/1000 [00:18<01:11, 12.01it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                 | 141/1000 [00:18<01:11, 12.00it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                 | 143/1000 [00:19<01:11, 12.01it/s]Training:  14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                 | 145/1000 [00:19<01:11, 11.88it/s]Training:  15%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                 | 147/1000 [00:19<01:11, 11.88it/s]Training:  15%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                                | 149/1000 [00:19<01:11, 11.93it/s]Epoch  150: Train=526810233824389807252439040.000000, Val=inf, Physics=0.001196, Time=0.0h
Training:  15%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                                | 151/1000 [00:19<01:10, 11.98it/s]Training:  15%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                | 153/1000 [00:19<01:10, 12.02it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                | 155/1000 [00:20<01:10, 12.03it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                | 157/1000 [00:20<01:09, 12.05it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                | 159/1000 [00:20<01:09, 12.07it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                               | 161/1000 [00:20<01:09, 12.08it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                               | 163/1000 [00:20<01:09, 12.08it/s]Training:  16%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                               | 165/1000 [00:20<01:09, 12.07it/s]Training:  17%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                               | 167/1000 [00:21<01:09, 12.07it/s]Training:  17%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                               | 169/1000 [00:21<01:08, 12.08it/s]Training:  17%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                              | 171/1000 [00:21<01:08, 12.07it/s]Training:  17%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                              | 173/1000 [00:21<01:10, 11.81it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                              | 175/1000 [00:21<01:09, 11.86it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                              | 177/1000 [00:21<01:09, 11.93it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                              | 179/1000 [00:22<01:08, 11.96it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                             | 181/1000 [00:22<01:08, 12.00it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                             | 183/1000 [00:22<01:07, 12.03it/s]Training:  18%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                             | 185/1000 [00:22<01:07, 12.04it/s]Training:  19%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                             | 187/1000 [00:22<01:07, 12.05it/s]Training:  19%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                             | 189/1000 [00:22<01:07, 12.07it/s]Training:  19%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                                            | 191/1000 [00:23<01:07, 12.07it/s]Training:  19%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                                                            | 193/1000 [00:23<01:06, 12.08it/s]Training:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                            | 195/1000 [00:23<01:06, 12.08it/s]Training:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                            | 197/1000 [00:23<01:06, 12.07it/s]Training:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                            | 199/1000 [00:23<01:06, 12.08it/s]Early stopping at epoch 200
Training:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                            | 199/1000 [00:23<01:35,  8.36it/s]
Traceback (most recent call last):
  File "/pscratch/sd/l/lindajin/DH_profile_kSZ_WL/examples/physics_neural_demo.py", line 761, in <module>
    trainer, results, efficiency_results = main('demo')
                                           ^^^^^^^^^^^^
  File "/pscratch/sd/l/lindajin/DH_profile_kSZ_WL/examples/physics_neural_demo.py", line 654, in main
    trainer, results, efficiency_results = run_physics_neural_training_demo()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/l/lindajin/DH_profile_kSZ_WL/examples/physics_neural_demo.py", line 467, in run_physics_neural_training_demo
    results = trainer.train(
              ^^^^^^^^^^^^^^
  File "/pscratch/sd/l/lindajin/DH_profile_kSZ_WL/examples/../src/models/physics_neural_trainer.py", line 416, in train
    print(f"\nâœ… Training completed in {total_time/3600:.1f} hours")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pscratch/sd/l/lindajin/DH_profile_kSZ_WL/examples/../src/models/physics_neural_trainer.py", line 457, in _evaluate_model
    # RÂ² score
              
  File "/global/u1/l/lindajin/virtualenvs/env1/lib/python3.11/site-packages/jax/_src/numpy/array_methods.py", line 589, in deferring_binary_op
    raise TypeError(f"unsupported operand type(s) for {opchar}: "
TypeError: unsupported operand type(s) for -: 'tuple' and 'ArrayImpl'
